clc;clear;
Q0 = 1.8;
Q1 = 1.8;
Q2 = 1.8;
Q3 = 1.8;
Q4 = 1.2;
Q5 = 2.4;
Q6 = 0.7;
Q7 = 0.7;
Q8 = 0.7;
Q9 = 0.7;

i= -3:0.1:6.9;
C_u = [];

for u=-3:0.1:-2.1
    N0 = (u+3)^3/6;
    %C_u = [C_u,N0];
    C_u = [C_u,N0*Q0];
end


for u=-2:0.1:-1.1
    N0 = -(u+3)^3/2 + 2*(u+3)^2-2*(u+3)+2/3;
    N1 = (u+2)^3/6;
    %C_u = [C_u,N1];
    C_u = [C_u,N0*Q0+N1*Q1];
end


for u=-1:0.1:-0.1
    N0 = (u+3)^3/2 - 4*(u+3)^2 + 10*(u+3)-22/3;
    N1 = -(u+2)^3/2 + 2*(u+2)^2-2*(u+2)+2/3;
    N2 = (u+1)^3/6;
    %C_u = [C_u,N2];
    C_u = [C_u,N0*Q0+N1*Q1+N2*Q2];
end


for u=0:0.1:0.9
    N0 = -(u+3)^3/6 + 2*(u+3)^2 - 8*(u+3) + 32/3;
    N1 = (u+2)^3/2 - 4*(u+2)^2 + 10*(u+2)-22/3;
    N2 = -(u+1)^3/2 + 2*(u+1)^2-2*(u+1)+2/3;
    N3 = (u)^3/6;
   % C_u = [C_u,N3];
    C_u = [C_u,N0*Q0+N1*Q1+N2*Q2+N3*Q3];
end


for u=1:0.1:1.9
    N1 = -(u+2)^3/6 + 2*(u+2)^2 - 8*(u+2) + 32/3;
    N2 = (u+1)^3/2 - 4*(u+1)^2 + 10*(u+1)-22/3;
    N3 = -(u)^3/2 + 2*(u)^2-2*(u)+2/3;
    N4 = (u-1)^3/6;
    %C_u = [C_u,N4];
    C_u = [C_u,N1*Q1+N2*Q2+N3*Q3+N4*Q4];
end


for u=2:0.1:2.9
    N2 = -(u+1)^3/6 + 2*(u+1)^2 - 8*(u+1) + 32/3;
    N3 = (u)^3/2 - 4*(u)^2 + 10*(u)-22/3;
    N4 = -(u-1)^3/2 + 2*(u-1)^2-2*(u-1)+2/3;
    N5 = (u-2)^3/6;
    %C_u = [C_u,N5];
    C_u = [C_u,N2*Q2+N3*Q3+N4*Q4+N5*Q5];
end

for u=3:0.1:3.9
    N3 = -(u)^3/6 + 2*(u)^2 - 8*(u) + 32/3;
    N4 = (u-1)^3/2 - 4*(u-1)^2 + 10*(u-1)-22/3;
    N5 = -(u-2)^3/2 + 2*(u-2)^2-2*(u-2)+2/3;
    N6 = (u-3)^3/6;
    %C_u = [C_u,N6];
    C_u = [C_u,N3*Q3+N4*Q4+N5*Q5+N6*Q6];
end

for u=4:0.1:4.9
    N4 = -(u-1)^3/6 + 2*(u-1)^2 - 8*(u-1) + 32/3;
    N5 = (u-2)^3/2 - 4*(u-2)^2 + 10*(u-2)-22/3;
    N6 = -(u-3)^3/2 + 2*(u-3)^2-2*(u-3)+2/3;
    N7 = (u-4)^3/6;
    %C_u = [C_u,N7];
    C_u = [C_u,N4*Q4+N5*Q5+N6*Q6+N7*Q7];
end

for u=5:0.1:5.9
    N5 = -(u-2)^3/6 + 2*(u-2)^2 - 8*(u-2) + 32/3;
    N6 = (u-3)^3/2 - 4*(u-3)^2 + 10*(u-3)-22/3;
    N7 = -(u-4)^3/2 + 2*(u-4)^2-2*(u-4)+2/3;
    N8 = (u-5)^3/6;
    %C_u = [C_u,N8];
    C_u = [C_u,N5*Q5+N6*Q6+N7*Q7+N8*Q8];
end

for u=6:0.1:6.9
    N6 = -(u-3)^3/6 + 2*(u-3)^2 - 8*(u-3) + 32/3;
    N7 = (u-4)^3/2 - 4*(u-4)^2 + 10*(u-4)-22/3;
    N8 = -(u-5)^3/2 + 2*(u-5)^2-2*(u-5)+2/3;
    N9 = (u-6)^3/6;
    %C_u = [C_u,N9];
    C_u = [C_u,N6*Q6+N7*Q7+N8*Q8+N9*Q9];
end
% 
% for u=7:0.1:7.9
%     N7 = -(u-4)^3/6 + 2*(u-4)^2 - 8*(u-4) + 32/3;
%     N8 = (u-5)^3/2 - 4*(u-5)^2 + 10*(u-5)-22/3;
%     N9 = -(u-6)^3/2 + 2*(u-6)^2-2*(u-6)+2/3;
%     N10 = (u-7)^3/6;
%     %C_u = [C_u,N10];
%     C_u = [C_u,N2*Q2+N3*Q3+N4*Q4+N5*Q5];
% end
hold on
plot(i(41:90),C_u(41:90),'r*-','LineWidth',3);
plot(i(61:71),C_u(61:71),'b*-','LineWidth',3);